<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Planilha de Vendas</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>Planilha de Vendas</h1>
  <table>
    <thead>
      <tr>
        <th>Funcionário</th>
        <th>Segunda</th>
        <th>Terça</th>
        <th>Quarta</th>
        <th>Quinta</th>
        <th>Sexta</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody id="vendas-body"></tbody>
    <tfoot>
      <tr>
        <th>Total Diário</th>
        <td id="total-monday">R$ 0,00</td>
        <td id="total-tuesday">R$ 0,00</td>
        <td id="total-wednesday">R$ 0,00</td>
        <td id="total-thursday">R$ 0,00</td>
        <td id="total-friday">R$ 0,00</td>
        <td id="total-geral">R$ 0,00</td>
      </tr>
    </tfoot>
  </table>

  <script>
    function formatCurrency(value) {
      return `R$ ${value.toFixed(2).replace('.', ',')}`;
    }

    document.addEventListener('DOMContentLoaded', function() {
      const data = JSON.parse(localStorage.getItem('spreadsheetData'));
      const tbody = document.getElementById('vendas-body');

      let totalMonday = 0, totalTuesday = 0, totalWednesday = 0, totalThursday = 0, totalFriday = 0, totalGeral = 0;

      if (data) {
        Object.entries(data).forEach(([name, dias]) => {
          const totalFuncionario = dias.monday + dias.tuesday + dias.wednesday + dias.thursday + dias.friday;
          totalMonday += dias.monday;
          totalTuesday += dias.tuesday;
          totalWednesday += dias.wednesday;
          totalThursday += dias.thursday;
          totalFriday += dias.friday;
          totalGeral += totalFuncionario;

          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${name}</td>
            <td>${formatCurrency(dias.monday)}</td>
            <td>${formatCurrency(dias.tuesday)}</td>
            <td>${formatCurrency(dias.wednesday)}</td>
            <td>${formatCurrency(dias.thursday)}</td>
            <td>${formatCurrency(dias.friday)}</td>
            <td>${formatCurrency(totalFuncionario)}</td>
          `;
          tbody.appendChild(row);
        });

        document.getElementById('total-monday').textContent = formatCurrency(totalMonday);
        document.getElementById('total-tuesday').textContent = formatCurrency(totalTuesday);
        document.getElementById('total-wednesday').textContent = formatCurrency(totalWednesday);
        document.getElementById('total-thursday').textContent = formatCurrency(totalThursday);
        document.getElementById('total-friday').textContent = formatCurrency(totalFriday);
        document.getElementById('total-geral').textContent = formatCurrency(totalGeral);
      } else {
        tbody.innerHTML = `<tr><td colspan="7">Nenhum dado disponível</td></tr>`;
      }
    });
  </script>
</body>
</html>